/* ======= Animations ======= */
$(document).ready(function() {

    //Only animate elements when using non-mobile devices
    if (isMobile.any === false) {

        /* Animate elements in #promo (homepage) */
        $('#promo .intro .title').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInLeft delayp1');
            }
        });
        $('#promo .intro .summary').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInRight delayp3');
            }
        });


        /* Animate elements in #video (homepage) */
        $('#video .title').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInLeft delayp1');
            }
        });

        $('#video .summary').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInRight delayp3');
            }
        });


        /* Animate elements in #features-promo */
        $('#features-promo .title').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInLeft delayp1');
            }
        });

        $('#features-promo .features-list').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInRight delayp3');
            }
        });

        $('.home-page .from-left').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInLeft delayp6');
            }
        });

        $('.home-page .from-right').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInRight delayp6');
            }
        });
        $('.home-page .from-bottom').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInUp delayp1');
            }
        });

        $('.tour-page .from-left').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInLeft delayp6');
            }
        });

        $('.tour-page .from-right').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInRight delayp6');
            }
        });

        $('.tour-page .from-bottom-1').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInDown delayp1');
            }
        });
        $('.tour-page .from-bottom-2').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInDown delayp2');
            }
        });
        $('.tour-page .from-bottom-3').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInDown delayp3');
            }
        });
        $('.tour-page .from-bottom-4').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInDown delayp4');
            }
        });
        /* Animate elements in #price-plan */
        $('#price-plan .price-figure').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInUp delayp1');
            }
        });

        $('#price-plan .heading .label').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInDown delayp6');
            }
        });

        /* Animate elements in #contact-main */
        $('#contact-main .item .icon').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInUp delayp1');
            }
        });

        /* Animate elements in #signup */

        $('#signup .signup-form').css('opacity', 0).one('inview', function(isInView) {
            if (isInView) {
                $(this).addClass('animated fadeInUp delayp6');
            }
        });
    }

});

$(document).ready(function() {
    
    /* ======= FAQ accordion ======= */

    function toggleIcon(e) {
        $(e.target)
            .prev('.panel-heading')
            .find('.panel-title a')
            .toggleClass('active')
            .find("i.fa")
            .toggleClass('fa-plus-square fa-minus-square');
    }
    $('.panel').on('hidden.bs.collapse', toggleIcon);
    $('.panel').on('shown.bs.collapse', toggleIcon);

    /* ======= Fixed header when scrolled ======= */

    $(window).bind('scroll', function() {
        if ($(window).scrollTop() > 0) {
            $('#header').addClass('navbar-fixed-top');
        } else {
            $('#header').removeClass('navbar-fixed-top');
        }
    });

    $("#agree").on('change', function() {
        if ($(this).is(':checked')) {
            $("#go-confirm").prop('disabled', false);
        } else {
            $("#go-confirm").prop('disabled', true);
        }
    });

    var $promoVideo = $('#promoVideo')[0];
    
    // #tour-videoのモーダルが開いたら
    $('#tour-video').on('shown.bs.modal', function () {
        $promoVideo.src += "https://www.youtube.com/embed/"+$promoVideo.dataset.src+"?rel=0&autoplay=1";
    });

    // #tour-videoのモーダルが閉じたら
    $('#tour-video').on('hidden.bs.modal', function () {
        $promoVideo.src += "https://www.youtube.com/embed/"+$promoVideo.dataset.src+"?rel=0&autoplay=0";
    });

    faqInit();
});

$(window).resize(function(){
    faqInit();
});

faqInit = function(){
    var $questions = $('#faqs .question');
    
    $questions.each(function(){
        var $question = $(this),
        $answer = $question.find('.answer')[0],
        setHeight = 0;
        for(i=0; i<$answer.childElementCount; i++){
            setHeight += parseInt($answer.children[i].clientHeight);
        }
        $answer.dataset.height = setHeight+30;
        $question.click(function(){
            if(!$(this).hasClass('active')){
                $questions.removeClass('active').find('.answer').css('height',0);
                $(this).addClass('active');
                $answer.style.height=$answer.dataset.height+'px';
            }else{
                $(this).removeClass('active').find('.answer').css('height',0);
            }
        });
    });
}